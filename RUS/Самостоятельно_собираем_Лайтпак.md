#Самостоятельно собираем Лайтпак
_Рекомендации по самостоятельному изготовлению Лайтпака в домашних условиях_

---

На этой странице содержится вся необходимая информация, которая может вам понадобиться для самостоятельного производства Лайтпака. Предполагается, что вам не нужно объяснять что такое ЛУТ, [с какой стороны браться за паяльник](http://pixelkit.ru/post/4656674848) и как правильно монтировать микросхемы в корпусах TQFP. Также мы надеемся, что вы уже ознакомились с [принципами работы](https://github.com/Atarity/Lightpack-docs/blob/master/RUS/%D0%9F%D1%80%D0%B8%D0%BD%D1%86%D0%B8%D0%BF_%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B.md) устройства.

Сразу же переходим к принципиальной схеме и таблице используемых компонентов (на все картинки можно кликать):

[<img src="https://lh3.googleusercontent.com/-GFRW15vGMUw/T5aVKUs7AoI/AAAAAAAACww/qLcmBqVQ8DM/s700/Lightpack60L_schematics.png">](https://picasaweb.google.com/lh/photo/tcp2lSpN84zuY0T_PuVEv9MTjNZETYmyPJy0liipFm0?feat=directlink)

Мы получаем годзиллионы вопросов о том, где купить все компоненты. Готовы посоветовать вам два проверенных нами интернет-магазина, которые торгуют в розницу по приемлемым ценам. Это [Элитан](http://elitan.ru/) и [Контест](http://www.elekont.ru/). Если вы миллионер, то можете попытать счастье в крупных сетях типа «Чип и Дип». Для тех, кто не любит возиться с лазерным утюгом, у нас в магазине можно купить [готовую печатную плату](http://store.pixelkit.ru/catalog/lpack6-pcb.html) для Лайтпака 6. А ещё специально для вас мы привезли много [драйверов светодиодов](http://store.pixelkit.ru/catalog/lightpack/led-drivers.html), потому что достать их в России оказалось не так просто, как мы думали.

Имя | Номинал/Название | Корпус
--- | --- | ---
IC1	| [Микроконтроллер Atmel AT90USB162](http://www.atmel.com/dyn/resources/prod_documents/doc7707.pdf) | TQFP32
IC2, IC3 | Драйвер светодиодов [SiTI DM631](http://www.siti.com.tw/product/spec/LED/DM631.pdf) или [DM633](http://www.siti.com.tw/product/spec/LED/DM633.pdf) | SOP24-1.27
IC4 | Супрессор [USB6B1](http://www.st.com/web/en/resource/technical/document/datasheet/CD00001361.pdf) | SO8
LED1-10 | Чип-светодиод [ReFond RF-W2SA50TS-A39](http://www.e-neon.ru/user_img/catalog_datasheets/rf-w2sa50ts-a39.pdf) | PLCC-6
C1, C2 | Конденсатор 18 пкФ (керамический) | 1206
С3, C5 | 4,7 мкФ, 16В (керамика/тантал) | 1206
С4 | 47 мкФ (танталовый) | C или D
C6 | 10 нФ, 50В (керамический) | 1206
C7, C8, C9 | 100 нФ (керамический) | 1206
R1 | Резистор 20 кОм | 1206
R2 | 100 кОм | 1206
R3, R4 | 22 Ом | 1206
R5, R6 | 3,9 кОм (3 кОм в случае DM633) | 1206
R7, R9 | 1 кОм | 1206
R8 | 1 МОм | 1206
D1 | BAV70 (сдвоенный диод) | SOT23
D2 | Диод SS14 | SMB
Q1 | Кварц 16 МГц (“лодочка”) | SMD
SW1 | Кнопка без фиксации для поверхностного монтажа | SMD
LED_TX | Простой светодиод для индикации состояния | 0805
USB | Гнездо USB mini B (USB/M-1J) | — 
PWR_JCK | Гнездо блока питания (DJK-02B) | — 

Разумеется, вам понадобится шлейф или другой провод по вкусу для того, чтобы соединить мастер-плату со светодиодами.

В ревизии устройства 6.0L появился супрессор (IC4). Этот элемент можно проигнорировать, если у вас возникли проблемы с его покупкой. Супрессор нужен для защиты шины данных USB. Фактически он представляет из себя набор диодов и ставится сразу же за гнездом USB таким образом, чтобы все 4 активных контакта проходили в первую очередь через него. Если вам кажется, что в схеме супрессор подключен как попало, то вы совершенно правы — это особенность библиотеки компонентов Eagle, которую мы так и не успели исправить. По этой же причине в разводке, на слое Unrouted есть два незаконченных (по мнению Eagle) соединения.

Также в 6й ревизии используются драйверы со встроенной ШИМ вместо тех, которые мы использовали раньше. Это компоненты производства компании SiTI, светодиодный драйвер DM631 или более продвинутый DM633. Эти компоненты не так-то просто найти в розничной продаже на территории нашей страны, поэтому, если вам известны (или вы проявили инициативу и специально нашли их) полные аналоги, то пришлите нам информацию о них. 

Отдельного внимания заслуживают токоограничивающие резисторы R5 и R6. В том случае, если ваши светодиоды будут отличаться от тех, которые использовали мы, вам придётся подбирать номинал резисторов R5 и R6 согласно даташиту светодиода. При слишком низком номинале у вас могут сгореть светодиоды, или будут сильно греться драйверы. При слишком высоком — уменьшится максимальная яркость. Кроме того, если вы **вместо указанных нами драйверов используете их старший аналог DM633, то вам следует использовать резисторы R5 и R6 с номиналом 3 кОм**.

Пару слов о самих светодиодах. Начиная с ревизии 5.5 мы используем простейшие светодиоды производства компании ReFond с общим анодом. На старых версиях Лайтпака использовались **CLV1A-FKB** производства компании [CREE](http://www.cree.com/). Это очень мелкие (3,2х2,8 мм) чип-светодиоды, но их яркость и равномерность пятна нас просто поражала. К сожалению, они значительно дороже обычных, и их сложно найти.

Во время реализации самых первых прототипов мы испробовали полдюжины разных выводных светодиодов (для сквозного монтажа) -- все они показали себя крайне плохо. Основные проблемы — чётко различимые следы каждого цвета RGB даже при их смешении и плохая работа на малых (менее 20 см) расстояниях от стены.

К Лайтпаку ревизии 6 можно без труда подключить светодиодные ленты, тем самым значительно увеличив количество светодиодов (но не зон захвата). Это может понадобиться, если вы хотите установить устройство на телевизор с большой диагональю. О том, какие ленты и блоки питания для этого подойдут вы можете прочесть в [специальном посте](http://pixelkit.ru/post/10930981074/5-5) нашего блога.

Принципиальную схему вместе с разводкой платы в формате бесплатной [Eagle CAD](http://cadsoft.de/) вы можете скачать из [соответствующей папки](https://github.com/Atarity/Lightpack/tree/master/Hardware) нашего открытого репозитория.

[<img src="https://lh3.googleusercontent.com/-YhRyNDFVunw/T5aVT6AlpKI/AAAAAAAACww/VAcb6jWTaok/s700/Lightpack60L_layout.png">](https://picasaweb.google.com/lh/photo/UDA16-O6El6-0XIG6WqC6dMTjNZETYmyPJy0liipFm0?feat=directlink)

Большинство дорожек выполнены шириной 0,3 мм — плата должна вытравиться ЛУТом без особого труда. Размеры мастер-платы 90х40 мм. Размеры плат для внешних светодиодов 15х15 мм. Таких плат можно сделать до 10ти штук. Нам не удалось полностью избежать второго слоя. Многое можно оптимизировать, но общая длина дорожек сильно возрастёт. Поэтому мы предлагаем вам не травить нижний слой, а просто сверлить текстолит и использовать провод или проволоку для прокладки этих 5 дорожек-перемычек.

В файле платы есть один дополнительный светодиод. Скорее всего вы захотите распечатать ещё несколько. Для этого в Eagle:

1. Закройте окно с принципиальной схемой устройства.
2. В окне с разводкой на панели инструментов слева последовательно выберите инструмент **Copy** и затем **Group**.
3. Выделяйте рамкой весь рисунок внешнего светодиода и жмите на нём правую кнопку мыши.
4. В нижней части меню увидите пункт **Copy:Group** — давите на него и размещайте новую платку где хотите.

Таким же образом можно перемещать группы объектов в Eagle.
При печати разводки не забывайте, что она нарисована на слое **Top** для SMD-компонентов. Это значит, что нужно установить галку **Mirror** в настройках печати из Eagle.

При монтаже компонентов обращайте внимание на особенности разводки. Следите, чтобы дороги, проходящие под кнопками и разъёмом USB, не замыкали на их корпуса. А когда будете припаивать шлейфы светодиодов, следите за тем, чтобы провода от контактных площадок RGB не замыкали на шину питания, которая обходит мастер-плату снаружи. Индикаторный светодиод LED_TX и токоограничивающий резистор к нему устанавливать не обязательно, но желательно.)

[<img src="https://lh4.googleusercontent.com/-g7Uohz9O7Us/T5aVcs4LhOI/AAAAAAAACww/e-CSrzZL0Yk/s700/Lightpack60L_vert.jpg">](https://picasaweb.google.com/lh/photo/doYnyRKyTiXJ5ypE4_19vNMTjNZETYmyPJy0liipFm0?feat=directlink)

После того, как устройство собрано, но ещё не установлено, в него нужно будет залить прошивку и проверить работоспособность. Сделать это можно прямо через USB без использования внешних программаторов. Вся процедура [описана в руководстве](https://github.com/Atarity/Lightpack-docs/blob/master/RUS/%D0%9E%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D1%8F%D0%B5%D0%BC_%D0%BF%D1%80%D0%BE%D1%88%D0%B8%D0%B2%D0%BA%D1%83_%D0%9B%D0%B0%D0%B9%D1%82%D0%BF%D0%B0%D0%BA%D0%B0_%D0%BF%D1%80%D0%B8_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D0%B8_%D1%83%D1%82%D0%B8%D0%BB%D0%B8%D1%82%D1%8B_FLIP.md). Кроме этого будет полезно ознакомиться с [описанием настроек](https://github.com/Atarity/Lightpack-docs/blob/master/RUS/%D0%9E%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BA_%D0%9F%D1%80%D0%B8%D0%B7%D0%BC%D0%B0%D1%82%D0%B8%D0%BA%D0%B0.md) программы захвата. Если программа отказывается подключаться к вашему устройству в Linux, то скорее всего вам придётся [расширить права USB-устройств](http://tuxpool.blogspot.com/2009/12/changing-usb-device-permissions-in.html) в настройках системы или просто закинуть [файл c правилом](https://github.com/Atarity/Lightpack/blob/master/93-lightpack.rules) в `/etc/udev/rules.d/` .
